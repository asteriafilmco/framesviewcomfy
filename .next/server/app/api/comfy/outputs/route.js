"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/comfy/outputs/route";
exports.ids = ["app/api/comfy/outputs/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "fs/promises":
/*!******************************!*\
  !*** external "fs/promises" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("fs/promises");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fcomfy%2Foutputs%2Froute&page=%2Fapi%2Fcomfy%2Foutputs%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fcomfy%2Foutputs%2Froute.ts&appDir=%2Fhome%2Fuser%2Fframesviewcomfy-1%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fhome%2Fuser%2Fframesviewcomfy-1&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D!":
/*!*******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fcomfy%2Foutputs%2Froute&page=%2Fapi%2Fcomfy%2Foutputs%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fcomfy%2Foutputs%2Froute.ts&appDir=%2Fhome%2Fuser%2Fframesviewcomfy-1%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fhome%2Fuser%2Fframesviewcomfy-1&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _home_user_framesviewcomfy_1_app_api_comfy_outputs_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/comfy/outputs/route.ts */ \"(rsc)/./app/api/comfy/outputs/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"standalone\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/comfy/outputs/route\",\n        pathname: \"/api/comfy/outputs\",\n        filename: \"route\",\n        bundlePath: \"app/api/comfy/outputs/route\"\n    },\n    resolvedPagePath: \"/home/user/framesviewcomfy-1/app/api/comfy/outputs/route.ts\",\n    nextConfigOutput,\n    userland: _home_user_framesviewcomfy_1_app_api_comfy_outputs_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/comfy/outputs/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZjb21meSUyRm91dHB1dHMlMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRmNvbWZ5JTJGb3V0cHV0cyUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRmNvbWZ5JTJGb3V0cHV0cyUyRnJvdXRlLnRzJmFwcERpcj0lMkZob21lJTJGdXNlciUyRmZyYW1lc3ZpZXdjb21meS0xJTJGYXBwJnBhZ2VFeHRlbnNpb25zPXRzeCZwYWdlRXh0ZW5zaW9ucz10cyZwYWdlRXh0ZW5zaW9ucz1qc3gmcGFnZUV4dGVuc2lvbnM9anMmcm9vdERpcj0lMkZob21lJTJGdXNlciUyRmZyYW1lc3ZpZXdjb21meS0xJmlzRGV2PXRydWUmdHNjb25maWdQYXRoPXRzY29uZmlnLmpzb24mYmFzZVBhdGg9JmFzc2V0UHJlZml4PSZuZXh0Q29uZmlnT3V0cHV0PXN0YW5kYWxvbmUmcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ2M7QUFDVztBQUN4RjtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLGlFQUFpRTtBQUN6RTtBQUNBO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ3VIOztBQUV2SCIsInNvdXJjZXMiOlsid2VicGFjazovL3ZpZXdjb21meS8/NmRiYiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBcHBSb3V0ZVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvYXBwLXJvdXRlL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IHBhdGNoRmV0Y2ggYXMgX3BhdGNoRmV0Y2ggfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvcGF0Y2gtZmV0Y2hcIjtcbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCIvaG9tZS91c2VyL2ZyYW1lc3ZpZXdjb21meS0xL2FwcC9hcGkvY29tZnkvb3V0cHV0cy9yb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJzdGFuZGFsb25lXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL2NvbWZ5L291dHB1dHMvcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9jb21meS9vdXRwdXRzXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcInJvdXRlXCIsXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiYXBwL2FwaS9jb21meS9vdXRwdXRzL3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiL2hvbWUvdXNlci9mcmFtZXN2aWV3Y29tZnktMS9hcHAvYXBpL2NvbWZ5L291dHB1dHMvcm91dGUudHNcIixcbiAgICBuZXh0Q29uZmlnT3V0cHV0LFxuICAgIHVzZXJsYW5kXG59KTtcbi8vIFB1bGwgb3V0IHRoZSBleHBvcnRzIHRoYXQgd2UgbmVlZCB0byBleHBvc2UgZnJvbSB0aGUgbW9kdWxlLiBUaGlzIHNob3VsZFxuLy8gYmUgZWxpbWluYXRlZCB3aGVuIHdlJ3ZlIG1vdmVkIHRoZSBvdGhlciByb3V0ZXMgdG8gdGhlIG5ldyBmb3JtYXQuIFRoZXNlXG4vLyBhcmUgdXNlZCB0byBob29rIGludG8gdGhlIHJvdXRlLlxuY29uc3QgeyByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcyB9ID0gcm91dGVNb2R1bGU7XG5jb25zdCBvcmlnaW5hbFBhdGhuYW1lID0gXCIvYXBpL2NvbWZ5L291dHB1dHMvcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fcomfy%2Foutputs%2Froute&page=%2Fapi%2Fcomfy%2Foutputs%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fcomfy%2Foutputs%2Froute.ts&appDir=%2Fhome%2Fuser%2Fframesviewcomfy-1%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fhome%2Fuser%2Fframesviewcomfy-1&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/comfy/outputs/route.ts":
/*!****************************************!*\
  !*** ./app/api/comfy/outputs/route.ts ***!
  \****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! fs */ \"fs\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var fs_promises__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! fs/promises */ \"fs/promises\");\n/* harmony import */ var fs_promises__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(fs_promises__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_3__);\n\n\n // Import promises version\n\n// Function to manually find a tEXt chunk in a PNG buffer\nconst findPngTextChunk = (buffer, keyword)=>{\n    try {\n        // Check for PNG signature\n        if (buffer.readUInt32BE(0) !== 0x89504e47 || buffer.readUInt32BE(4) !== 0x0d0a1a0a) {\n            // console.warn('Not a valid PNG file or buffer too short.');\n            return undefined;\n        }\n        let offset = 8; // Start after PNG signature\n        while(offset < buffer.length){\n            const length = buffer.readUInt32BE(offset);\n            const typeOffset = offset + 4;\n            const type = buffer.toString(\"ascii\", typeOffset, typeOffset + 4);\n            const dataOffset = typeOffset + 4;\n            const crcOffset = dataOffset + length;\n            if (type === \"tEXt\") {\n                // Find the null separator between keyword and text\n                const nullSeparatorIndex = buffer.indexOf(0, dataOffset, \"ascii\");\n                if (nullSeparatorIndex !== -1 && nullSeparatorIndex < crcOffset) {\n                    const currentKeyword = buffer.toString(\"ascii\", dataOffset, nullSeparatorIndex);\n                    if (currentKeyword === keyword) {\n                        const text = buffer.toString(\"utf8\", nullSeparatorIndex + 1, crcOffset);\n                        return text;\n                    }\n                }\n            }\n            // Move to the next chunk (Length + Type + Data + CRC = 4 + 4 + length + 4 bytes)\n            offset = crcOffset + 4;\n            // Basic safety check\n            if (offset > buffer.length) {\n                console.warn(\"[WARN] PNG parsing went beyond buffer length.\");\n                break;\n            }\n        }\n    } catch (e) {\n        console.error(\"[ERROR] Error manually parsing PNG chunks:\", e);\n    }\n    return undefined;\n};\nasync function GET() {\n    try {\n        // Get the ComfyUI output directory from environment variable or use default\n        const comfyOutputDir = process.env.COMFY_OUTPUT_DIR || path__WEBPACK_IMPORTED_MODULE_3___default().join(process.cwd(), \"comfy\", \"output\");\n        console.log(\"[DEBUG] ComfyUI output directory:\", comfyOutputDir);\n        console.log(\"[DEBUG] Directory exists?\", fs__WEBPACK_IMPORTED_MODULE_1___default().existsSync(comfyOutputDir));\n        // Check if directory exists\n        if (!fs__WEBPACK_IMPORTED_MODULE_1___default().existsSync(comfyOutputDir)) {\n            console.log(\"[ERROR] Output directory not found:\", comfyOutputDir);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Output directory not found\"\n            }, {\n                status: 404\n            });\n        }\n        // Read all files in the directory\n        const files = fs__WEBPACK_IMPORTED_MODULE_1___default().readdirSync(comfyOutputDir);\n        // console.log('[DEBUG] Files found in directory:', files);\n        // Filter for image files and get their stats and prompt\n        const outputs = await Promise.all(files.filter((file)=>/\\.png$/i.test(file)) // Filter specifically for PNG files now\n        .map(async (file)=>{\n            const filePath = path__WEBPACK_IMPORTED_MODULE_3___default().join(comfyOutputDir, file);\n            let stats;\n            let fileBuffer;\n            let prompt = undefined;\n            try {\n                // Read file stats and content\n                stats = await fs_promises__WEBPACK_IMPORTED_MODULE_2___default().stat(filePath); // Use async stat\n                fileBuffer = await fs_promises__WEBPACK_IMPORTED_MODULE_2___default().readFile(filePath);\n                // --- Extract prompt using manual parser ---\n                const promptJsonString = findPngTextChunk(fileBuffer, \"prompt\");\n                if (promptJsonString) {\n                    try {\n                        const promptData = JSON.parse(promptJsonString);\n                        let extractedText = undefined;\n                        for(const nodeId in promptData){\n                            const node = promptData[nodeId];\n                            if (node?.class_type?.includes(\"CLIPTextEncode\") && node?.inputs?.text) {\n                                extractedText = node.inputs.text;\n                                break;\n                            }\n                        }\n                        prompt = extractedText;\n                        if (!prompt) {\n                            console.warn(`[WARN] Found prompt JSON in ${file}, but couldn't extract text from expected location.`);\n                        }\n                    } catch (parseError) {\n                        console.warn(`[WARN] Failed to parse embedded prompt JSON in ${file}:`, parseError);\n                        if (typeof promptJsonString === \"string\" && promptJsonString.length < 500) {\n                            prompt = promptJsonString;\n                        }\n                    }\n                } else {\n                    console.log(`[DEBUG] No 'prompt' text chunk found in ${file}`);\n                }\n                if (!prompt) {\n                    const workflowJsonString = findPngTextChunk(fileBuffer, \"workflow\");\n                    if (workflowJsonString) {\n                        console.log(`[DEBUG] Found 'workflow' chunk in ${file}, implement parsing if needed.`);\n                    }\n                }\n            // --- End extract prompt ---\n            } catch (readError) {\n                console.error(`[ERROR] Failed to read or process file ${filePath}:`, readError);\n                // If we can't read the file, we can't return info for it\n                return null; // Mark for filtering out later\n            }\n            // Ensure stats is defined before accessing birthtime/size\n            if (!stats) return null;\n            return {\n                name: file,\n                path: `/comfy/output/${encodeURIComponent(file)}`,\n                created: stats.birthtime,\n                size: stats.size,\n                prompt: prompt // Add the prompt here\n            };\n        }));\n        // Filter out null results (from read errors) and sort\n        const validOutputs = outputs.filter((output)=>output !== null);\n        validOutputs.sort((a, b)=>b.created.getTime() - a.created.getTime());\n        // console.log('[DEBUG] Found', validOutputs.length, 'PNG files with prompts (if available)');\n        // console.log('[DEBUG] First few outputs:', validOutputs.slice(0, 3));\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            outputs: validOutputs\n        });\n    } catch (error) {\n        console.error(\"[ERROR] Error reading outputs:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Failed to read outputs\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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akIsT0FBTyxPQUFPO1lBRW5CLE9BQU87Z0JBQ0hrQixNQUFNdEI7Z0JBQ050QyxNQUFNLENBQUMsY0FBYyxFQUFFNkQsbUJBQW1CdkIsTUFBTSxDQUFDO2dCQUNqRHdCLFNBQVNwQixNQUFNcUIsU0FBUztnQkFDeEJDLE1BQU10QixNQUFNc0IsSUFBSTtnQkFDaEJwQixRQUFRQSxPQUFPLHNCQUFzQjtZQUN6QztRQUNKO1FBR0gsc0RBQXNEO1FBQ3ZELE1BQU1xQixlQUFlL0IsUUFBUUcsTUFBTSxDQUFDNkIsQ0FBQUEsU0FBVUEsV0FBVztRQUN6REQsYUFBYUUsSUFBSSxDQUFDLENBQUNDLEdBQUdDLElBQU1BLEVBQUVQLE9BQU8sQ0FBQ1EsT0FBTyxLQUFLRixFQUFFTixPQUFPLENBQUNRLE9BQU87UUFFbkUsOEZBQThGO1FBQzlGLHVFQUF1RTtRQUV2RSxPQUFPekUscURBQVlBLENBQUNpQyxJQUFJLENBQUM7WUFBRUksU0FBUytCO1FBQWE7SUFDckQsRUFBRSxPQUFPN0MsT0FBTztRQUNaSCxRQUFRRyxLQUFLLENBQUMsa0NBQWtDQTtRQUNoRCxPQUFPdkIscURBQVlBLENBQUNpQyxJQUFJLENBQUM7WUFBRVYsT0FBTztRQUF5QixHQUFHO1lBQUVXLFFBQVE7UUFBSTtJQUNoRjtBQUNKIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdmlld2NvbWZ5Ly4vYXBwL2FwaS9jb21meS9vdXRwdXRzL3JvdXRlLnRzPzU5ZGYiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dFJlc3BvbnNlIH0gZnJvbSAnbmV4dC9zZXJ2ZXInO1xuaW1wb3J0IGZzIGZyb20gJ2ZzJztcbmltcG9ydCBmc3AgZnJvbSAnZnMvcHJvbWlzZXMnOyAvLyBJbXBvcnQgcHJvbWlzZXMgdmVyc2lvblxuaW1wb3J0IHBhdGggZnJvbSAncGF0aCc7XG5cbi8vIE1pbmltYWwgaW50ZXJmYWNlIGZvciB0aGUgY2h1bmsgc3RydWN0dXJlIHdlIG5lZWRcbmludGVyZmFjZSBQbmdUZXh0Q2h1bmsge1xuICAgIG5hbWU6IHN0cmluZztcbiAgICBrZXl3b3JkPzogc3RyaW5nO1xuICAgIHRleHQ/OiBzdHJpbmc7XG4gICAgLy8gQWRkIG90aGVyIHByb3BlcnRpZXMgaWYgbmVlZGVkIGJhc2VkIG9uIGxpYnJhcnkgb3V0cHV0XG59XG5cbi8vIEZ1bmN0aW9uIHRvIG1hbnVhbGx5IGZpbmQgYSB0RVh0IGNodW5rIGluIGEgUE5HIGJ1ZmZlclxuY29uc3QgZmluZFBuZ1RleHRDaHVuayA9IChidWZmZXI6IEJ1ZmZlciwga2V5d29yZDogc3RyaW5nKTogc3RyaW5nIHwgdW5kZWZpbmVkID0+IHtcbiAgICB0cnkge1xuICAgICAgICAvLyBDaGVjayBmb3IgUE5HIHNpZ25hdHVyZVxuICAgICAgICBpZiAoYnVmZmVyLnJlYWRVSW50MzJCRSgwKSAhPT0gMHg4OTUwNGU0NyB8fCBidWZmZXIucmVhZFVJbnQzMkJFKDQpICE9PSAweDBkMGExYTBhKSB7XG4gICAgICAgICAgICAvLyBjb25zb2xlLndhcm4oJ05vdCBhIHZhbGlkIFBORyBmaWxlIG9yIGJ1ZmZlciB0b28gc2hvcnQuJyk7XG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IG9mZnNldCA9IDg7IC8vIFN0YXJ0IGFmdGVyIFBORyBzaWduYXR1cmVcbiAgICAgICAgd2hpbGUgKG9mZnNldCA8IGJ1ZmZlci5sZW5ndGgpIHtcbiAgICAgICAgICAgIGNvbnN0IGxlbmd0aCA9IGJ1ZmZlci5yZWFkVUludDMyQkUob2Zmc2V0KTtcbiAgICAgICAgICAgIGNvbnN0IHR5cGVPZmZzZXQgPSBvZmZzZXQgKyA0O1xuICAgICAgICAgICAgY29uc3QgdHlwZSA9IGJ1ZmZlci50b1N0cmluZygnYXNjaWknLCB0eXBlT2Zmc2V0LCB0eXBlT2Zmc2V0ICsgNCk7XG4gICAgICAgICAgICBjb25zdCBkYXRhT2Zmc2V0ID0gdHlwZU9mZnNldCArIDQ7XG4gICAgICAgICAgICBjb25zdCBjcmNPZmZzZXQgPSBkYXRhT2Zmc2V0ICsgbGVuZ3RoO1xuXG4gICAgICAgICAgICBpZiAodHlwZSA9PT0gJ3RFWHQnKSB7XG4gICAgICAgICAgICAgICAgLy8gRmluZCB0aGUgbnVsbCBzZXBhcmF0b3IgYmV0d2VlbiBrZXl3b3JkIGFuZCB0ZXh0XG4gICAgICAgICAgICAgICAgY29uc3QgbnVsbFNlcGFyYXRvckluZGV4ID0gYnVmZmVyLmluZGV4T2YoMCwgZGF0YU9mZnNldCwgJ2FzY2lpJyk7XG4gICAgICAgICAgICAgICAgaWYgKG51bGxTZXBhcmF0b3JJbmRleCAhPT0gLTEgJiYgbnVsbFNlcGFyYXRvckluZGV4IDwgY3JjT2Zmc2V0KSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRLZXl3b3JkID0gYnVmZmVyLnRvU3RyaW5nKCdhc2NpaScsIGRhdGFPZmZzZXQsIG51bGxTZXBhcmF0b3JJbmRleCk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjdXJyZW50S2V5d29yZCA9PT0ga2V5d29yZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdGV4dCA9IGJ1ZmZlci50b1N0cmluZygndXRmOCcsIG51bGxTZXBhcmF0b3JJbmRleCArIDEsIGNyY09mZnNldCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGV4dDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gTW92ZSB0byB0aGUgbmV4dCBjaHVuayAoTGVuZ3RoICsgVHlwZSArIERhdGEgKyBDUkMgPSA0ICsgNCArIGxlbmd0aCArIDQgYnl0ZXMpXG4gICAgICAgICAgICBvZmZzZXQgPSBjcmNPZmZzZXQgKyA0O1xuXG4gICAgICAgICAgICAvLyBCYXNpYyBzYWZldHkgY2hlY2tcbiAgICAgICAgICAgIGlmIChvZmZzZXQgPiBidWZmZXIubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybignW1dBUk5dIFBORyBwYXJzaW5nIHdlbnQgYmV5b25kIGJ1ZmZlciBsZW5ndGguJyk7XG4gICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdbRVJST1JdIEVycm9yIG1hbnVhbGx5IHBhcnNpbmcgUE5HIGNodW5rczonLCBlKTtcbiAgICB9XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbn07XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBHRVQoKSB7XG4gICAgdHJ5IHtcbiAgICAgICAgLy8gR2V0IHRoZSBDb21meVVJIG91dHB1dCBkaXJlY3RvcnkgZnJvbSBlbnZpcm9ubWVudCB2YXJpYWJsZSBvciB1c2UgZGVmYXVsdFxuICAgICAgICBjb25zdCBjb21meU91dHB1dERpciA9IHByb2Nlc3MuZW52LkNPTUZZX09VVFBVVF9ESVIgfHwgcGF0aC5qb2luKHByb2Nlc3MuY3dkKCksICdjb21meScsICdvdXRwdXQnKTtcbiAgICAgICAgXG4gICAgICAgIGNvbnNvbGUubG9nKCdbREVCVUddIENvbWZ5VUkgb3V0cHV0IGRpcmVjdG9yeTonLCBjb21meU91dHB1dERpcik7XG4gICAgICAgIGNvbnNvbGUubG9nKCdbREVCVUddIERpcmVjdG9yeSBleGlzdHM/JywgZnMuZXhpc3RzU3luYyhjb21meU91dHB1dERpcikpO1xuICAgICAgICBcbiAgICAgICAgLy8gQ2hlY2sgaWYgZGlyZWN0b3J5IGV4aXN0c1xuICAgICAgICBpZiAoIWZzLmV4aXN0c1N5bmMoY29tZnlPdXRwdXREaXIpKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnW0VSUk9SXSBPdXRwdXQgZGlyZWN0b3J5IG5vdCBmb3VuZDonLCBjb21meU91dHB1dERpcik7XG4gICAgICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ091dHB1dCBkaXJlY3Rvcnkgbm90IGZvdW5kJyB9LCB7IHN0YXR1czogNDA0IH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gUmVhZCBhbGwgZmlsZXMgaW4gdGhlIGRpcmVjdG9yeVxuICAgICAgICBjb25zdCBmaWxlcyA9IGZzLnJlYWRkaXJTeW5jKGNvbWZ5T3V0cHV0RGlyKTtcbiAgICAgICAgLy8gY29uc29sZS5sb2coJ1tERUJVR10gRmlsZXMgZm91bmQgaW4gZGlyZWN0b3J5OicsIGZpbGVzKTtcbiAgICAgICAgXG4gICAgICAgIC8vIEZpbHRlciBmb3IgaW1hZ2UgZmlsZXMgYW5kIGdldCB0aGVpciBzdGF0cyBhbmQgcHJvbXB0XG4gICAgICAgIGNvbnN0IG91dHB1dHMgPSBhd2FpdCBQcm9taXNlLmFsbCggLy8gVXNlIFByb21pc2UuYWxsIGZvciBhc3luYyBvcGVyYXRpb25zIGluc2lkZSBtYXBcbiAgICAgICAgICAgIGZpbGVzXG4gICAgICAgICAgICAuZmlsdGVyKGZpbGUgPT4gL1xcLnBuZyQvaS50ZXN0KGZpbGUpKSAvLyBGaWx0ZXIgc3BlY2lmaWNhbGx5IGZvciBQTkcgZmlsZXMgbm93XG4gICAgICAgICAgICAubWFwKGFzeW5jIChmaWxlKSA9PiB7IC8vIE1ha2UgdGhlIG1hcCBjYWxsYmFjayBhc3luY1xuICAgICAgICAgICAgICAgIGNvbnN0IGZpbGVQYXRoID0gcGF0aC5qb2luKGNvbWZ5T3V0cHV0RGlyLCBmaWxlKTtcbiAgICAgICAgICAgICAgICBsZXQgc3RhdHM6IGZzLlN0YXRzO1xuICAgICAgICAgICAgICAgIGxldCBmaWxlQnVmZmVyOiBCdWZmZXIgfCB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgbGV0IHByb21wdDogc3RyaW5nIHwgdW5kZWZpbmVkID0gdW5kZWZpbmVkO1xuXG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgLy8gUmVhZCBmaWxlIHN0YXRzIGFuZCBjb250ZW50XG4gICAgICAgICAgICAgICAgICAgIHN0YXRzID0gYXdhaXQgZnNwLnN0YXQoZmlsZVBhdGgpOyAvLyBVc2UgYXN5bmMgc3RhdFxuICAgICAgICAgICAgICAgICAgICBmaWxlQnVmZmVyID0gYXdhaXQgZnNwLnJlYWRGaWxlKGZpbGVQYXRoKTtcblxuICAgICAgICAgICAgICAgICAgICAvLyAtLS0gRXh0cmFjdCBwcm9tcHQgdXNpbmcgbWFudWFsIHBhcnNlciAtLS1cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcHJvbXB0SnNvblN0cmluZyA9IGZpbmRQbmdUZXh0Q2h1bmsoZmlsZUJ1ZmZlciwgJ3Byb21wdCcpO1xuICAgICAgICAgICAgICAgICAgICBpZiAocHJvbXB0SnNvblN0cmluZykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwcm9tcHREYXRhID0gSlNPTi5wYXJzZShwcm9tcHRKc29uU3RyaW5nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgZXh0cmFjdGVkVGV4dDogc3RyaW5nIHwgdW5kZWZpbmVkID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3Qgbm9kZUlkIGluIHByb21wdERhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgbm9kZSA9IHByb21wdERhdGFbbm9kZUlkXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGU/LmNsYXNzX3R5cGU/LmluY2x1ZGVzKCdDTElQVGV4dEVuY29kZScpICYmIG5vZGU/LmlucHV0cz8udGV4dCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXh0cmFjdGVkVGV4dCA9IG5vZGUuaW5wdXRzLnRleHQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9tcHQgPSBleHRyYWN0ZWRUZXh0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghcHJvbXB0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oYFtXQVJOXSBGb3VuZCBwcm9tcHQgSlNPTiBpbiAke2ZpbGV9LCBidXQgY291bGRuJ3QgZXh0cmFjdCB0ZXh0IGZyb20gZXhwZWN0ZWQgbG9jYXRpb24uYCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAocGFyc2VFcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybihgW1dBUk5dIEZhaWxlZCB0byBwYXJzZSBlbWJlZGRlZCBwcm9tcHQgSlNPTiBpbiAke2ZpbGV9OmAsIHBhcnNlRXJyb3IpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHByb21wdEpzb25TdHJpbmcgPT09ICdzdHJpbmcnICYmIHByb21wdEpzb25TdHJpbmcubGVuZ3RoIDwgNTAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9tcHQgPSBwcm9tcHRKc29uU3RyaW5nO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coYFtERUJVR10gTm8gJ3Byb21wdCcgdGV4dCBjaHVuayBmb3VuZCBpbiAke2ZpbGV9YCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgIGlmICghcHJvbXB0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgd29ya2Zsb3dKc29uU3RyaW5nID0gZmluZFBuZ1RleHRDaHVuayhmaWxlQnVmZmVyLCAnd29ya2Zsb3cnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICBpZiAod29ya2Zsb3dKc29uU3RyaW5nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGBbREVCVUddIEZvdW5kICd3b3JrZmxvdycgY2h1bmsgaW4gJHtmaWxlfSwgaW1wbGVtZW50IHBhcnNpbmcgaWYgbmVlZGVkLmApO1xuICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLy8gLS0tIEVuZCBleHRyYWN0IHByb21wdCAtLS1cblxuICAgICAgICAgICAgICAgIH0gY2F0Y2ggKHJlYWRFcnJvcjogYW55KSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYFtFUlJPUl0gRmFpbGVkIHRvIHJlYWQgb3IgcHJvY2VzcyBmaWxlICR7ZmlsZVBhdGh9OmAsIHJlYWRFcnJvcik7XG4gICAgICAgICAgICAgICAgICAgIC8vIElmIHdlIGNhbid0IHJlYWQgdGhlIGZpbGUsIHdlIGNhbid0IHJldHVybiBpbmZvIGZvciBpdFxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDsgLy8gTWFyayBmb3IgZmlsdGVyaW5nIG91dCBsYXRlclxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIEVuc3VyZSBzdGF0cyBpcyBkZWZpbmVkIGJlZm9yZSBhY2Nlc3NpbmcgYmlydGh0aW1lL3NpemVcbiAgICAgICAgICAgICAgICBpZiAoIXN0YXRzKSByZXR1cm4gbnVsbDtcblxuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IGZpbGUsXG4gICAgICAgICAgICAgICAgICAgIHBhdGg6IGAvY29tZnkvb3V0cHV0LyR7ZW5jb2RlVVJJQ29tcG9uZW50KGZpbGUpfWAsIC8vIEtlZXAgb3JpZ2luYWwgcGF0aCBmb3IgY2xpZW50XG4gICAgICAgICAgICAgICAgICAgIGNyZWF0ZWQ6IHN0YXRzLmJpcnRodGltZSxcbiAgICAgICAgICAgICAgICAgICAgc2l6ZTogc3RhdHMuc2l6ZSxcbiAgICAgICAgICAgICAgICAgICAgcHJvbXB0OiBwcm9tcHQgLy8gQWRkIHRoZSBwcm9tcHQgaGVyZVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9KVxuICAgICAgICApO1xuICAgICAgICBcbiAgICAgICAgIC8vIEZpbHRlciBvdXQgbnVsbCByZXN1bHRzIChmcm9tIHJlYWQgZXJyb3JzKSBhbmQgc29ydFxuICAgICAgICBjb25zdCB2YWxpZE91dHB1dHMgPSBvdXRwdXRzLmZpbHRlcihvdXRwdXQgPT4gb3V0cHV0ICE9PSBudWxsKSBhcyBBcnJheTxFeGNsdWRlPHR5cGVvZiBvdXRwdXRzW251bWJlcl0sIG51bGw+PjtcbiAgICAgICAgdmFsaWRPdXRwdXRzLnNvcnQoKGEsIGIpID0+IGIuY3JlYXRlZC5nZXRUaW1lKCkgLSBhLmNyZWF0ZWQuZ2V0VGltZSgpKTtcbiAgICAgICAgXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKCdbREVCVUddIEZvdW5kJywgdmFsaWRPdXRwdXRzLmxlbmd0aCwgJ1BORyBmaWxlcyB3aXRoIHByb21wdHMgKGlmIGF2YWlsYWJsZSknKTtcbiAgICAgICAgLy8gY29uc29sZS5sb2coJ1tERUJVR10gRmlyc3QgZmV3IG91dHB1dHM6JywgdmFsaWRPdXRwdXRzLnNsaWNlKDAsIDMpKTtcblxuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBvdXRwdXRzOiB2YWxpZE91dHB1dHMgfSk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignW0VSUk9SXSBFcnJvciByZWFkaW5nIG91dHB1dHM6JywgZXJyb3IpO1xuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ0ZhaWxlZCB0byByZWFkIG91dHB1dHMnIH0sIHsgc3RhdHVzOiA1MDAgfSk7XG4gICAgfVxufSAiXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwiZnMiLCJmc3AiLCJwYXRoIiwiZmluZFBuZ1RleHRDaHVuayIsImJ1ZmZlciIsImtleXdvcmQiLCJyZWFkVUludDMyQkUiLCJ1bmRlZmluZWQiLCJvZmZzZXQiLCJsZW5ndGgiLCJ0eXBlT2Zmc2V0IiwidHlwZSIsInRvU3RyaW5nIiwiZGF0YU9mZnNldCIsImNyY09mZnNldCIsIm51bGxTZXBhcmF0b3JJbmRleCIsImluZGV4T2YiLCJjdXJyZW50S2V5d29yZCIsInRleHQiLCJjb25zb2xlIiwid2FybiIsImUiLCJlcnJvciIsIkdFVCIsImNvbWZ5T3V0cHV0RGlyIiwicHJvY2VzcyIsImVudiIsIkNPTUZZX09VVFBVVF9ESVIiLCJqb2luIiwiY3dkIiwibG9nIiwiZXhpc3RzU3luYyIsImpzb24iLCJzdGF0dXMiLCJmaWxlcyIsInJlYWRkaXJTeW5jIiwib3V0cHV0cyIsIlByb21pc2UiLCJhbGwiLCJmaWx0ZXIiLCJmaWxlIiwidGVzdCIsIm1hcCIsImZpbGVQYXRoIiwic3RhdHMiLCJmaWxlQnVmZmVyIiwicHJvbXB0Iiwic3RhdCIsInJlYWRGaWxlIiwicHJvbXB0SnNvblN0cmluZyIsInByb21wdERhdGEiLCJKU09OIiwicGFyc2UiLCJleHRyYWN0ZWRUZXh0Iiwibm9kZUlkIiwibm9kZSIsImNsYXNzX3R5cGUiLCJpbmNsdWRlcyIsImlucHV0cyIsInBhcnNlRXJyb3IiLCJ3b3JrZmxvd0pzb25TdHJpbmciLCJyZWFkRXJyb3IiLCJuYW1lIiwiZW5jb2RlVVJJQ29tcG9uZW50IiwiY3JlYXRlZCIsImJpcnRodGltZSIsInNpemUiLCJ2YWxpZE91dHB1dHMiLCJvdXRwdXQiLCJzb3J0IiwiYSIsImIiLCJnZXRUaW1lIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./app/api/comfy/outputs/route.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fcomfy%2Foutputs%2Froute&page=%2Fapi%2Fcomfy%2Foutputs%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fcomfy%2Foutputs%2Froute.ts&appDir=%2Fhome%2Fuser%2Fframesviewcomfy-1%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fhome%2Fuser%2Fframesviewcomfy-1&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();